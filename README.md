<div align="center">

# FlowSage

**🚀 专为CTF设计的智能流量分析工具**

[![Version](https://img.shields.io/badge/version-v3.0.0-blue.svg)](https://github.com/Lyscf/FlowSage)
[![Platform](https://img.shields.io/badge/platform-Windows%20%7C%20Linux%20%7C%20macOS-blue.svg)](https://github.com/Lyscf/FlowSage)
[![Language](https://img.shields.io/badge/language-Go-00ADD8.svg)](https://github.com/Lyscf/FlowSage)
[![CTF](https://img.shields.io/badge/CTF-Ready-green.svg)](https://github.com/Lyscf/FlowSage)

*零配置 • 智能分析 • CTF专用*

[功能特性](#功能特性) • [快速开始](#快速开始) • [使用文档](#使用文档) • [更新日志](#更新日志)

</div>

---

## 🎯 项目简介

FlowSage 是一款专为 CTF 比赛设计的流量分析工具，能够帮助选手快速、准确地从复杂的网络流量中提取关键信息。**v3.0 全面重构为 Golang**，实现跨平台支持、性能大幅提升，通过深度协议解析和智能算法，实现**一行命令完成复杂流量分析**。

> 💡 **注意**：本项目目前为闭源项目，欢迎有兴趣的开发者联系合作，CTFer可在Issues中提出功能需求和反馈。


> 💡 **注意**：本项目目前存在网络验证，使用公网NTP服务验证当前时间，一个版本可在版本发布后一个月内正常可用。


> 💡 **注意**：项目已添加离线授权功能，需要离线运行的师傅可以加QQ群1041810310免费获取离线授权，离线授权有效期同样为每个版本发布后一个月。


> 💡 **注意**：由于项目进行了重构，部分功能（如自动化分析）暂时无法使用，属于正常现象，这些功能将在后续版本中逐渐完善。

---

## 项目截图

<div align="center">

### 🖥️ 程序菜单
<img src="img/1.png" alt="程序菜单" width="600"  style="border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); margin: 10px;">

### 💉 SQL-时间盲注流量还原
<img src="img/3.png" alt="SQL-时间盲注流量还原" width="600"  style="border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); margin: 10px;">

### 🎯 SQL-布尔盲注流量还原
<img src="img/4.png" alt="SQL-布尔盲注流量还原" width="600"  style="border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); margin: 10px;">

### 🖱️ USB鼠标流量还原
<img src="img/2.png" alt="USB鼠标流量还原" width="600"  style="border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); margin: 10px;">

### ⌨️ USB键盘流量还原
<img src="img/5.png" alt="USB键盘流量还原" width="600"  style="border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); margin: 10px;">

### 🔌 Telnet流量分析-会话重建
<img src="img/6.png" alt="Telnet流量分析-会话重建" width="600"  style="border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); margin: 10px;">

### 🔍 端口扫描分析器
<img src="img/7.png" alt="端口扫描分析器" width="600"  style="border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); margin: 10px;">

### 📧 SMTP流量分析器
<img src="img/8.png" alt="SMTP流量分析器" width="600"  style="border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); margin: 10px;">

</div>
---

## ✨ 功能特性

### 🔍 核心能力

- **🌐 全协议深度解析**：支持 HTTP、SQL、FTP、SMTP、Telnet、SMB、DNS、ARP、Redis、MongoDB、ICMP、蓝牙、WebShell、EV3、端口扫描、鼠标轨迹、键盘数据 等 20+ 主流协议
- **🛡️ WebShell检测**：智能WebShell明文传输解析
- **🤖 EV3机器人协议**：完整支持LEGO EV3机器人通信协议解析
- **📱 增强蓝牙支持**：支持HCI、L2CAP、RFCOMM等底层协议，完整蓝牙通信栈解析
- **📁 智能文件识别**：自动识别 200+ 文件类型
- **🎌 CTF专属优化**：内置多层 Flag 检测算法，支持 15+ 种 Flag 格式
- **⚡ 零配置分析**：开箱即用，无需复杂配置
- **🚀 跨平台支持**：支持 Windows、Linux、macOS 等主流操作系统

### 🛠️ 专业功能

| 协议类型       | 分析能力                                          | CTF应用场景            |
| -------------- | ------------------------------------------------- | ---------------------- |
| **HTTP** | 会话重建 + 文件隐写检测 + 分段传输支持 + 自动文件提取 | Web取证、隐写分析      |
| **SQL**  | 智能盲注重建 + 多字段并行提取 + 增强型payload识别 | SQL注入分析、数据提取  |
| **USB**  | 扫描码转换 + 鼠标轨迹可视化 + 修饰键支持          | 键盘流量解析、输入重建 |
| **WiFi** | 握手包捕获 + 网络拓扑分析 + 弱加密检测            | 无线安全分析           |
| **FTP**  | 会话重建 + 文件传输分析 + 认证信息提取            | 文件传输取证           |
| **蓝牙** | 设备识别 + 数据包分析 + 连接日志提取              | 蓝牙设备取证           |
| **SMTP** | 邮件头解析 + 附件提取 + 垃圾邮件检测              | 邮件取证               |
| **SMB**  | 文件共享分析 + NTLM认证 + 会话重建                | 文件传输取证、认证分析  |
| **Telnet** | 密码爆破分析 + 终端内容还原 + 会话重建          | 远程登录取证、密码分析 |
| **端口扫描** | 扫描模式识别 + 工具特征分析 + 目标识别        | 网络侦察分析           |
| **鼠标轨迹** | 轨迹可视化 + 点击事件分析 + 操作序列重建      | 用户行为分析           |
| **键盘数据** | 按键序列还原 + 功能键识别 + 组合键解析        | 输入行为重建           |
| **DNS** | 域名解析分析 + mDNS支持 + DoH检测 + 查询记录提取 | 域名解析取证、DNS隧道检测 |
| **ARP** | 地址映射分析 + ARP欺骗检测 + 网络拓扑重建     | 网络攻击检测、拓扑分析 |
| **Redis** | 命令解析 + 数据操作分析 + 认证信息提取       | NoSQL数据库取证        |
| **MongoDB** | 查询解析 + 文档操作分析 + 认证流程重建     | MongoDB数据库取证      |
| **ICMP** | 协议分析 + Ping追踪 + 网络诊断数据提取      | 网络诊断、隐蔽通信检测 |

### v3.0.0 重大更新 🎉

- **🔄 Golang重构**：完全重写为Go语言，性能提升，内存占用减少
- **🌍 跨平台支持**：支持Windows、Linux、macOS
- **🛡️ WebShell检测引擎**：新增专业WebShell明文传输解析，支持主流WebShell工具识别
- **🤖 EV3机器人协议**：完整支持LEGO EV3机器人通信协议，包含指令解析和传感器数据
- **📱 蓝牙协议增强**：深度支持HCI、L2CAP、RFCOMM等底层协议，完整蓝牙通信栈
- **📁 FTP协议重构**：增强主被动模式支持，优化文件传输分析和完整性校验
- **🔒 安全加固**：内置反分析保护、代码混淆、TLS加密等多重安全机制
- **⚡ 性能优化**：并发处理、内存优化、算法改进，处理大文件能力显著提升

## 🚀 快速开始

### 系统要求

- **Windows**: Windows 10/11 (x64/ARM64)
- **Linux**: Ubuntu 18.04+, CentOS 7+, Debian 10+ (x64/ARM64)
- **macOS**: macOS 10.15+ (x64/ARM64 Apple Silicon)

### 安装步骤

1. **下载工具**

   ```bash
   # 从Release页面下载最新版本
   # Windows: flowsage-v3-windows-amd64-secure.exe / flowsage-v3-windows-arm64-secure.exe
   # Linux: flowsage-v3-linux-amd64-secure / flowsage-v3-linux-arm64-secure
   # macOS: flowsage-v3-darwin-amd64-secure / flowsage-v3-darwin-arm64-secure
   ```

2. **准备流量文件**

   - 使用 Wireshark 打开流量文件
   - 点击 **文件** → **导出分组解析结果**
   - 选择 **JSON** 格式保存
3. **运行分析**

   ```bash
   # Windows
   ./flowsage-v3.exe
   
   # Linux/macOS
   ./flowsage-v3
   ```

## 📖 使用文档

## 🏗️ 技术架构

### 算法优势

- **智能会话重建**：基于TCP序列号的精确重建算法，支持分段传输和乱序重组
- **多层Flag检测**：正则表达式 + 熵分析 + 格式验证 + 语义分析
- **自适应编码识别**：支持50+编码格式自动转换，包括变种编码
- **损坏数据修复**：智能文件重组和数据恢复，支持多种修复算法
- **WebShell智能识别**：基于行为特征和流量模式的WebShell检测引擎
- **蓝牙协议栈解析**：完整的HCI/L2CAP/RFCOMM协议解析和状态机重建
- **EV3机器人协议**：LEGO EV3通信协议的完整实现和指令解析
- **并发处理优化**：Go协程池和管道优化，大幅提升处理速度

## 📈 性能指标

| 指标                 | v2.9.0 | v3.0.0 | 说明                   |
| -------------------- | ------ | ------ | ---------------------- |
| **协议覆盖率** | 17+协议 | 20+协议 | 新增WebShell、EV3、增强蓝牙/FTP等 |
| **跨平台支持** | Windows | 全平台 | Windows/Linux/macOS |

## 🔄 更新日志

### v3.0.0 (2025-09-13) 🎉 **重大版本发布**

#### 🔄 **架构重构**

- **完全重写为Golang**：告别Python，拥抱高性能的Go语言
- **跨平台支持**：Windows、Linux、macOS全平台原生支持
- **性能革命性提升**：处理速度提升300%+，内存占用减少60%
- **单文件部署**：无依赖部署，文件体积从~100MB减少至~15MB

#### 🆕 **新协议支持**

- **🛡️ WebShell检测引擎**：专业WebShell明文传输解析
  - 支持冰蝎(Behinder)、哥斯拉(Godzilla)、蚁剑(AntSword)识别
  - 智能命令执行分析和加密通信解析
  - 基于流量特征的WebShell行为检测
- **🤖 EV3机器人协议**：完整LEGO EV3机器人通信协议支持
  - 指令解析和执行序列重建
  - 传感器数据采集分析
  - 电机控制指令解析
  - 机器人行为序列重现

#### 📱 **协议增强**

- **🔷 蓝牙协议全面升级**：
  - **HCI层**：主机控制接口完整解析
  - **L2CAP协议**：逻辑链路控制和适配协议
  - **RFCOMM协议**：串口模拟协议支持
  - **ATT/GATT协议**：属性协议和通用属性配置文件
  - **设备配对分析**：完整配对过程重建
- **📁 FTP协议重构升级**：
  - 增强主动/被动模式支持
  - 文件传输完整性校验
  - 优化认证信息提取
  - 支持FTPS安全传输分析

#### ⚡ **性能优化**

- **并发处理**：Go协程池优化，支持大规模并发分析
- **内存管理**：智能内存回收，减少60%内存占用
- **算法优化**：核心算法重写，提升300%处理速度
- **流式处理**：支持大文件流式分析，突破内存限制

### v2.9.0 (2025-09-04)

- **🌐 DNS协议全面支持**：新增完整DNS流量分析功能，支持标准DNS、mDNS和DoH协议检测
- **📡 ARP流量分析器**：新增地址解析协议分析，智能检测ARP欺骗攻击和网络拓扑重建
- **💾 Redis协议分析**：新增NoSQL数据库协议支持，完整解析Redis命令执行和数据操作
- **🍃 MongoDB协议分析**：新增MongoDB数据库协议分析，支持查询解析和认证流程重建
- **📶 ICMP协议分析**：新增网络诊断协议支持，检测Ping追踪、网络诊断和隐蔽通信
- **🖱️ USB鼠标增强**：优化USB提取器，新增6字节格式鼠标数据处理和Y值动态缩放
- **📊 数据质量提升**：改进数据分析逻辑，优化报告生成质量和整体可读性
- **🛠️ 代码架构优化**：重构代码结构，提升系统维护性和运行稳定性

### v2.8.0 (2025-08-23)

- **🌐 DNS协议全面支持**：新增完整DNS流量分析功能，支持标准DNS、mDNS和DoH协议检测
- **📡 ARP流量分析器**：新增地址解析协议分析，智能检测ARP欺骗攻击和网络拓扑重建
- **💾 Redis协议分析**：新增NoSQL数据库协议支持，完整解析Redis命令执行和数据操作
- **🍃 MongoDB协议分析**：新增MongoDB数据库协议分析，支持查询解析和认证流程重建
- **📶 ICMP协议分析**：新增网络诊断协议支持，检测Ping追踪、网络诊断和隐蔽通信
- **🖱️ USB鼠标增强**：优化USB提取器，新增6字节格式鼠标数据处理和Y值动态缩放
- **📊 数据质量提升**：改进数据分析逻辑，优化报告生成质量和整体可读性
- **🛠️ 代码架构优化**：重构代码结构，提升系统维护性和运行稳定性

### v2.7.0 (2025-08-19)

- **🖱️ 鼠标轨迹解析器**：重构鼠标轨迹可视化和分析功能，支持用户操作行为重建
- **⌨️ 键盘数据还原**：重构键盘输入重建，支持功能按键和组合键识别，完整还原用户输入
- **🚀 SMB协议分析器**：新增文件共享和NTLM认证分析，支持Windows网络取证
- **⏰ NTP时间验证**：重构网络时间同步验证，保证软件可用性
- **🎯 增强Flag提取**：优化CTF标志检测算法，提升识别准确率和覆盖面
- **🔧 稳定性提升**：修复已知问题，提升系统整体稳定性和可靠性

### v2.6.0 (2025-08-17)

- 🚀 **增强SQL注入分析器**：新增反向时间盲注检测算法，检测准确率提升
- 🎯 **优化标志提取器**：支持冒号格式标志检测，增强多种CTF标志格式识别能力
- 🔧 **Telnet功能重构**：改进终端重建算法，提升会话解析准确性和稳定性
- ⚡ **HTTP分析优化**：移除404和200状态码请求数量限制，支持更全面的流量分析
- 🛠️ **配置管理升级**：全新模块化配置架构，支持FTP、SMTP、SQL注入等模块独立配置
- 📡 **网络检查功能**：新增网络连接状态检测，提升工具运行稳定性
- 📊 **日志分析器**：新增专用访问日志分析模块，支持Web服务器日志智能解析
- 🏗️ **架构重构优化**：重构报告生成模块，优化项目结构，提升代码可维护性
- 🐛 **修复文件处理**：优化文件名处理逻辑，修复特殊字符文件名解析问题

### v2.5.0 (2025-08-08)

- 📡 **新增Telnet协议支持**：完整的Telnet会话解析和重建功能
- 🔐 **Telnet密码分析**：智能识别弱密码、爆破攻击和登录凭据
- 💻 **终端内容还原**：完整重现Telnet会话的终端操作和命令执行
- 📁 **HTTP文件自动提取**：默认自动提取所有HTTP传输的文件，无需手动操作

### v2.3.0 (2025-08-05)

- 🔧 **重构SQL解析器**：全新算法架构，检测准确率提升至98%+
- 🎛️ **新增交互式菜单**：菜单操作菜单，支持多种分析模式选择
- 🚩 **增强Flag匹配**：支持15+种Flag格式，包括变形和隐藏格式
- 📡 **HTTP 206分段传输**：完整支持分段响应的智能重组和分析
- ⚡ **性能大幅优化**：分析速度提升40%，内存占用降低30%

### v2.2.0 (2025-08-02)

- ✨ 优化SQL注入分析算法，提高检测准确率至95%+
- 🔧 增强USB键盘流量解析，支持更多键盘布局
- 🐛 修复FTP文件传输分析中的编码问题
- 📊 新增HTML可视化报告功能

### v2.1.0 (2025-07-30)

- 🏗️ 全面重构项目架构，采用模块化设计
- 🔍 增强SQL注入分析，支持多种注入技术
- 🖱️ 优化USB键盘流量解析，支持鼠标轨迹分析
- 🌐 统一HTTP处理器，整合所有HTTP功能

## 🤝 贡献指南

虽然本项目暂时闭源，但我们非常欢迎社区贡献：

### 💡 需求反馈

- 在 [Issues](https://github.com/Lyscf/FlowSage/issues) 中提出功能需求
- 分享 CTF 题目和流量样本
- 反馈使用体验和建议

### 🤝 合作机会

- CTF题库建设
- 新功能开发
- 测试和文档完善

## 📞 联系我们

- **技术支持**: lyscf#proton.me (将#替换为@)
- **Bug反馈**: [GitHub Issues](https://github.com/Lyscf/FlowSage/issues)

## 📄 许可证

本项目目前为专有软件，未经授权禁止复制、分发和修改。

**⭐ 如果这个项目对你有帮助，请给我们一个Star！**

Made with ❤️ for CTF Community

---

## 🆕 v3.0.0 新增协议支持

除了表格中的协议，v3.0.0 还新增以下重要协议支持：

| 协议类型 | 分析能力 | CTF应用场景 |
| -------- | -------- | ---------- |
| **WebShell** | **新增** 明文传输检测 + 冰蝎/哥斯拉/蚁剑识别 + 命令执行分析 + 加密通信解析 | WebShell检测与分析 |
| **EV3机器人** | **新增** LEGO EV3协议完整支持 + 指令解析 + 传感器数据 + 电机控制分析 | 机器人通信取证 |

## 📝 免责声明

本项目仅供学习和研究使用，使用者需遵守相关法律法规，确保合法合规使用。我们不对因使用本项目而导致的任何法律责任或损失承担责任。
