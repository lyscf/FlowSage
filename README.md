# FlowSage

**🚀 专为CTF设计的智能流量分析工具**

[![Version](https://img.shields.io/badge/version-v2.6.0-blue.svg)](https://github.com/Lyscf/FlowSage)
[![Platform](https://img.shields.io/badge/platform-Windows-blue.svg)](https://github.com/Lyscf/FlowSage)
[![CTF](https://img.shields.io/badge/CTF-Ready-green.svg)](https://github.com/Lyscf/FlowSage)

*零配置 • 智能分析 • CTF专用*

[功能特性](#功能特性) • [快速开始](#快速开始) • [使用文档](#使用文档) • [更新日志](#更新日志)

</div>

---

## 🎯 项目简介

FlowSage 是一款专为 CTF 比赛设计的流量分析工具，能够帮助选手快速、准确地从复杂的网络流量中提取关键信息。通过深度协议解析和智能算法，实现**一行命令完成复杂流量分析**。

> 💡 **注意**：本项目目前为闭源项目，欢迎有兴趣的开发者联系合作，CTFer可在Issues中提出功能需求和反馈。

> 💡 **注意**：本项目目前存在网络验证，使用pool.ntp.org验证当前时间，一个版本可在版本发布后一个月内正常可用。

## ✨ 功能特性

### 🔍 核心能力

- **🌐 全协议深度解析**：支持 HTTP、SQL、FTP、SMTP、Telnet 等 9+ 主流协议
- **📁 智能文件识别**：自动识别 200+ 文件类型
- **🎌 CTF专属优化**：内置多层 Flag 检测算法，支持 15+ 种 Flag 格式
- **⚡ 零配置分析**：开箱即用，无需复杂配置
- **🎛️ 交互式菜单**：全新图形化操作界面，操作更便捷

### 🛠️ 专业功能

| 协议类型         | 分析能力                                              | CTF应用场景            |
| ---------------- | ----------------------------------------------------- | ---------------------- |
| **HTTP**   | 会话重建 + 文件隐写检测 + 分段传输支持 + 自动文件提取 | Web取证、隐写分析      |
| **SQL**    | 智能盲注重建 + 多字段并行提取 + 增强型payload识别     | SQL注入分析、数据提取  |
| **USB**    | 扫描码转换 + 鼠标轨迹可视化 + 修饰键支持              | 键盘流量解析、输入重建 |
| **WiFi**   | 握手包捕获 + 网络拓扑分析 + 弱加密检测                | 无线安全分析           |
| **FTP**    | 会话重建 + 文件传输分析 + 认证信息提取                | 文件传输取证           |
| **蓝牙**   | 设备识别 + 数据包分析 + 连接日志提取                  | 蓝牙设备取证           |
| **SMTP**   | 邮件头解析 + 附件提取 + 垃圾邮件检测                  | 邮件取证               |
| **SMB**    | 文件共享分析 + 认证信息提取 + 会话重建                | 文件传输取证           |
| **Telnet** | 密码爆破分析 + 终端内容还原 + 会话重建                | 远程登录取证、密码分析 |

### v2.6.0 新特性

- **🚀 增强SQL注入分析器**：新增反向时间盲注检测，提升检测准确率至99%+
- **🎯 优化标志提取器**：支持冒号格式的标志检测，增强CTF标志识别能力
- **🔧 Telnet功能重构**：改进终端重建功能，提升会话解析准确性
- **⚡ HTTP分析优化**：移除状态码限制，支持更全面的HTTP流量分析
- **🛠️ 配置管理升级**：全新配置架构，支持模块化配置管理
- **📡 网络检查功能**：新增网络连接状态检测和验证
- **📊 日志分析器**：新增专用日志分析模块，支持访问日志智能解析

## 🚀 快速开始

### 系统要求

- Windows 10/11

### 安装步骤

1. **下载工具**

   ```bash
   # 从Release页面下载最新版本
   # 或联系开发者获取试用版本
   ```
2. **准备流量文件**

   - 使用 Wireshark 打开流量文件
   - 点击 **文件** → **导出分组解析结果**
   - 选择 **JSON** 格式保存
3. **运行分析**

   ```bash
   # 一键启动分析（新增交互式菜单）
   ./FlowSage.exe

   ```

### 快速示例

```bash
# 分析HTTP流量
./FlowSage.exe http_traffic.json

# 分析SQL注入流量  
./FlowSage.exe sql_injection.json

# 分析Telnet流量
./FlowSage.exe telnet_traffic.json

# 分析USB键盘流量
./FlowSage.exe usb_keyboard.json
```

## 📖 使用文档

### 🎛️ 交互式菜单

v2.5.0新增的交互式菜单让操作更加直观：

```text
============================🚀 FlowSage 主菜单============================
📋 请选择操作:
  [1] 🔍 自动检测并分析流量
  [2] 🌐 HTTP流量分析
  [3] 💉 SQL注入专用分析
  [4] 🔷 蓝牙流量分析
  [5] 📁 FTP流量分析
  [6] 📧 SMTP流量分析
  [7] 🐬 MySQL协议分析
  [8] 🔌 USB流量分析
  [9] 📁 SMB流量分析
  [10] 📶 WiFi流量分析
  [11] 🔌 Telnet流量分析
  [12] ⚙️ 设置和配置
  [13] 📚 帮助和文档
  [0] 🚪 退出程序
======================================================================
请选择 [0-13]:
```

### HTTP流量分析（支持206分段传输）

```bash
./FlowSage.exe web_traffic.json
```

**输出示例：**

```text
🌐 HTTP流量分析完成
📊 总请求数: 245 | 成功响应: 198 | 分段传输: 12 | 错误响应: 35
🔍 发现可疑文件: 3个
📁 自动提取文件: flag.txt, secret.zip, image.png, config.xml, data.json
📡 分段传输文件: large_file.pdf (206响应重组完成)
🚩 检测到Flag: flag{web_traffic_analysis_2024}
```

### SQL注入分析

```bash
./FlowSage.exe sql_injection.json
```

**输出示例：**

```text
🎯 SQL注入分析摘要
============================================================
总HTTP请求数: 392
SQL注入请求数: 333
请求-响应对数: 392

--- 注入方法分类 ---
布尔盲注请求: 248
时间盲注请求: 248
联合注入请求: 0
错误注入请求: 0

🎯 从盲注中提取的数据:
   字段 'inferred_flag': ek`fz`rc`peb3010cerfce12rce|
   🔓 解码结果: flag{asdaqfc4121dfsgdf23sdf}
   🚩 解码后的Flag: flag{asdaqfc4121dfsgdf23sdf}

✅ 成功的盲注测试: 322 个
⏱️ 平均响应时间: 0.272s
```

### USB键盘流量解析

```bash
./FlowSage.exe usb_keyboard.json
```

**功能特性：**

- ✅ 扫描码到字符的完整转换
- ✅ 支持 Shift、Ctrl、Alt 组合键
- ✅ 时间戳序列重建
- ✅ 鼠标轨迹可视化

### Telnet流量分析

```bash
./FlowSage.exe telnet_traffic.json
```

**输出示例：**

```text
======================================================================
                            📊 Telnet流量分析摘要
======================================================================
📁 输入文件: telnet.json
📦 总数据包数: 187
🔌 Telnet数据包数: 139
💻 会话数量: 2
🔑 密码数量: 11
📝 命令数量: 0
🔐 登录尝试: 9
✅ 成功登录: 4
❌ 失败登录: 1
======================================================================

[6] 密码: youcannevergetthis ✅
    时间: May 10, 2022 10:30:59.711903000 中国标准时间
    来源: 192.168.246.1 -> 192.168.246.28
    上下文: 从包序号分析重建密码: youcannevergetthis (从包 57 到包 106)...
    提取方法: packet_sequence_analysis
    状态: correct
======================================================================
🖥️ 重建终端会话...

📺 终端会话: 192.168.246.1:61760-192.168.246.28:23
   客户端: 192.168.246.1
   服务器: 192.168.246.28
   交互数量: 82
✅ 终端重建结果已保存到: C:\Users\Lyscf\Desktop\FlowSage-Dev\output\terminal_reconstruction_20250810_182038.txt
======================================================================

================================================================================
Telnet终端会话重建
================================================================================

会话: 192.168.246.1 -> 192.168.246.28
================================================================================
Password: 
ct
Login incorrect
ubuntu login: 
ctf
Password: 
youcannevergetthis
Last login: Tue May 10 10:26:46 CST 2022 from _gateway on pts/1
*** System restart required ***
0;ctf@ubuntu: ~ctf@ubuntu:~$ 
ls
Documents  examples.desktop  Pictures  Templates
0;ctf@ubuntu: ~ctf@ubuntu:~$ 
cat /etc/passwd
dnsmasq:x:108:6
telnetd:x:123:128::/nonexistent:/usr/sbin/nologin
0;ctf@ubuntu: ~ctf@ubuntu:~$ 
================================================================================

```

**功能特性：**

- ✅ 完整的Telnet会话重建和解析
- ✅ 智能密码爆破检测和分析
- ✅ 终端内容完整还原
- ✅ 登录凭据自动提取
- ✅ 会话时间线重建

## 🏗️ 技术架构

### 核心模块

```text
FlowSage/
├── 📦 协议解析器/
│   ├── HTTPAnalyzer    # HTTP协议深度解析
│   ├── SQLAnalyzer     # SQL注入专项分析  
│   ├── USBAnalyzer     # USB设备流量解析
│   ├── WiFiAnalyzer    # 无线网络分析
│   ├── SMTPAnalyzer    # SMTP邮件协议解析
│   ├── BluetoothAnalyzer # 蓝牙流量分析
│   ├── FTPAnalyzer     # FTP协议分析
│   └── TelnetAnalyzer  # Telnet协议分析

├── 🔍 检测引擎/
│   ├── FlagDetector    # 多格式Flag检测
│   ├── FileExtractor   # 智能文件提取
│   ├── PayloadAnalyzer # 攻击载荷识别
│   └── CredentialAnalyzer # 凭据分析引擎
└── 📊 报告生成器/
    ├── JSONReporter    # 结构化数据输出
    └── TXTReporter     # 可读性报告
```

### 算法优势

- **智能会话重建**：基于TCP序列号的精确重建算法，支持分段传输
- **多层Flag检测**：正则表达式 + 熵分析 + 格式验证 + 语义分析
- **自适应编码识别**：支持30+编码格式自动转换
- **损坏数据修复**：智能文件重组和数据恢复
- **Telnet会话分析**：完整终端内容还原和密码破解检测
- **HTTP文件自动提取**：智能识别并提取所有传输文件

## 📈 性能指标

| 指标                 | 表现   | 说明                           |
| -------------------- | ------ | ------------------------------ |
| **Flag检出率** | 95%+   | 基于500+CTF题目测试            |
| **协议覆盖率** | 9+协议 | HTTP、SQL、USB、WiFi、Telnet等 |

## 🔄 更新日志

### v2.6.0 (2025-08-10)

- 🚀 **增强SQL注入分析器**：新增反向时间盲注检测算法，检测准确率提升
- 🎯 **优化标志提取器**：支持冒号格式标志检测，增强多种CTF标志格式识别能力
- 🔧 **Telnet功能重构**：改进终端重建算法，提升会话解析准确性和稳定性
- ⚡ **HTTP分析优化**：移除404和200状态码请求数量限制，支持更全面的流量分析
- 🛠️ **配置管理升级**：全新模块化配置架构，支持FTP、SMTP、SQL注入等模块独立配置
- 📡 **网络检查功能**：新增网络连接状态检测，提升工具运行稳定性
- 📊 **日志分析器**：新增专用访问日志分析模块，支持Web服务器日志智能解析
- 🏗️ **架构重构优化**：重构报告生成模块，优化项目结构，提升代码可维护性
- 🐛 **修复文件处理**：优化文件名处理逻辑，修复特殊字符文件名解析问题

### v2.5.0 (2025-08-08)

- 📡 **新增Telnet协议支持**：完整的Telnet会话解析和重建功能
- 🔐 **Telnet密码分析**：智能识别弱密码、爆破攻击和登录凭据
- 💻 **终端内容还原**：完整重现Telnet会话的终端操作和命令执行
- 📁 **HTTP文件自动提取**：默认自动提取所有HTTP传输的文件，无需手动操作

### v2.3.0 (2025-08-05)

- 🔧 **重构SQL解析器**：全新算法架构，检测准确率提升至98%+
- 🎛️ **新增交互式菜单**：菜单操作菜单，支持多种分析模式选择
- 🚩 **增强Flag匹配**：支持15+种Flag格式，包括变形和隐藏格式
- 📡 **HTTP 206分段传输**：完整支持分段响应的智能重组和分析
- ⚡ **性能大幅优化**：分析速度提升40%，内存占用降低30%

### v2.2.0 (2025-08-02)

- ✨ 优化SQL注入分析算法，提高检测准确率至95%+
- 🔧 增强USB键盘流量解析，支持更多键盘布局
- 🐛 修复FTP文件传输分析中的编码问题
- 📊 新增HTML可视化报告功能

### v2.1.0 (2025-07-30)

- 🏗️ 全面重构项目架构，采用模块化设计
- 🔍 增强SQL注入分析，支持多种注入技术
- 🖱️ 优化USB键盘流量解析，支持鼠标轨迹分析
- 🌐 统一HTTP处理器，整合所有HTTP功能

## 🤝 贡献指南

虽然本项目暂时闭源，但我们非常欢迎社区贡献：

### 💡 需求反馈

- 在 [Issues](https://github.com/Lyscf/FlowSage/issues) 中提出功能需求
- 分享 CTF 题目和流量样本
- 反馈使用体验和建议

### 🤝 合作机会

- CTF题库建设
- 新功能开发
- 测试和文档完善

## 📞 联系我们

- **技术支持**: lyscf#proton.me (将#替换为@)
- **Bug反馈**: [GitHub Issues](https://github.com/Lyscf/FlowSage/issues)

## 📄 许可证

本项目目前为专有软件，未经授权禁止复制、分发和修改。

**⭐ 如果这个项目对你有帮助，请给我们一个Star！**

Made with ❤️ for CTF Community

## 📝 免责声明

本项目仅供学习和研究使用，使用者需遵守相关法律法规，确保合法合规使用。我们不对因使用本项目而导致的任何法律责任或损失承担责任。
